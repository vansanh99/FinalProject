{
    "family": "unix",
    "OSCheck": {
        "command_list": [
            {
                "id": "1",
                "command": "cat[,]/etc/lsb-release[|]grep[,]DISTRIB_ID",
                "expectationPattern": "^\\s*DISTRIB_ID\\s*=\\s*Ubuntu\\s*(#.*)?$"
            },
            {
                "id": "2",
                "command": "cat[,]/etc/lsb-release[|]grep[,]DISTRIB_RELEASE",
                "expectationPattern": "^\\s*DISTRIB_RELEASE\\s*=\\s*18.04\\s*(#.*)?$"
            }
        ],
        "operator": "1&&2"
    },
    "description": "This document provides prescriptive guidance for establishing a secure configuration posture for <b>Ubuntu Linux 18.04 <br></br>LTS<b> systems running on x86 and x64 platforms.",
    "templateReport": "CIS_Ubuntu_Linux_18.04_LTS_Benchmark_v2.0.1",
    "audit": {
        "level_list": [
            {
                "name": "Level 1 - Workstation",
                "description": "<p>Items in this profile intend to:</p><ul><li>be practical and prudent;</li><li>provide a clear security benefit; and</li><li>not inhibit the utility of the technology beyond acceptable means.</li></ul><p>This profile is intended for workstations.</p>",
                "id": "1WS"
            },
            {
                "name": "Level 1 - Server",
                "description": "<p>Items in this profile intend to:</p><ul><li>be practical and prudent;</li><li>provide a clear security benefit; and</li><li>not inhibit the utility of the technology beyond acceptable means.</li></ul><p>This profile is intended for servers.</p>",
                "id": "1SV"
            },
            {
                "name": "Level 2 - Workstation",
                "description": "<p>This profile extends the \"Level 1 - Workstation\" profile. Items in this profile exhibit one or more of the following characteristics:</p><ul><li>are intended for environments or use cases where security is paramount.</li><li>acts as defense in depth measure.</li><li>may negatively inhibit the utility or performance of the technology.</li></ul><p>This profile is intended for workstations.</p>",
                "id": "2WS"
            },
            {
                "name": "Level 2 - Server",
                "description": "<p>This profile extends the \"Level 1 - Server\" profile. Items in this profile exhibit one or more of the following characteristics:</p><ul><li>are intended for environments or use cases where security is paramount.</li><li>acts as defense in depth measure.</li><li>may negatively inhibit the utility or performance of the technology.</li></ul><p>This profile is intended for servers.</p>",
                "id": "2SV"
            }
        ],
        "chapters": [
            {
                "id": "1",
                "name": "Initial Setup",
                "categories": [
                    {
                        "id": "1.1",
                        "name": "filesystem configuration",
                        "groups": [
                            {
                                "id": "1.1.1",
                                "name": "Disable unused filesystems",
                                "report": [
                                    {
                                        "id": "1.1.1.1",
                                        "description": "Ensure mounting of cramfs is disabled",
                                        "pattern": "^\\s*install\\s+cramfs\\s+\/bin\/true\\s*$",
                                        "path": "/etc/modprobe.d/cramfs.conf",
                                        "level": "1WS,1SV",
                                        "type": "FILE_PATTERN"
                                    },
                                    {
                                        "id": "1.1.1.2",
                                        "description": "Ensure mounting of freevxfs filesystems is disabled",
                                        "pattern": "^\\s*install\\s+freevxfs\\s+\/bin\/true\\s*$",
                                        "path": "/etc/modprobe.d/freevxfs.conf",
                                        "level": "1WS,1SV",
                                        "type": "FILE_PATTERN"
                                    },
                                    {
                                        "id": "1.1.1.3",
                                        "description": "Ensure mounting of jffs2 filesystems is disabled",
                                        "pattern": "^\\s*install\\s+jffs2\\s+\/bin\/true\\s*$",
                                        "path": "/etc/modprobe.d/jffs2.conf",
                                        "level": "1WS,1SV",
                                        "type": "FILE_PATTERN"
                                    },
                                    {
                                        "id": "1.1.1.4",
                                        "description": "Ensure mounting of hfs filesystems is disabled",
                                        "pattern": "^\\s*install\\s+hfs\\s+\/bin\/true\\s*$",
                                        "path": "/etc/modprobe.d/hfs.conf",
                                        "level": "1WS,1SV",
                                        "type": "FILE_PATTERN"
                                    },
                                    {
                                        "id": "1.1.1.5",
                                        "description": "Ensure mounting of hfsplus filesystems is disabled",
                                        "pattern": "^\\s*install\\s+hfsplus\\s+\/bin\/true\\s*$",
                                        "path": "/etc/modprobe.d/hfsplus.conf",
                                        "level": "1WS,1SV",
                                        "type": "FILE_PATTERN"
                                    },
                                    {
                                        "id": "1.1.1.6",
                                        "description": "Ensure mounting of squashfs filesystems is disabled",
                                        "pattern": "^\\s*install\\s+squashfs\\s+\/bin\/true\\s*$",
                                        "path": "/etc/modprobe.d/squashfs.conf",
                                        "level": "1WS,1SV",
                                        "type": "FILE_PATTERN"
                                    },
                                    {
                                        "id": "1.1.1.7",
                                        "description": "Ensure mounting of udf filesystems is disabled",
                                        "pattern": "^\\s*install\\s+udf\\s+\/bin\/true\\s*$",
                                        "path": "/etc/modprobe.d/udf.conf",
                                        "level": "1WS,1SV",
                                        "type": "FILE_PATTERN"
                                    },
                                    {
                                        "id": "1.1.2",
                                        "description": "Ensure separate partition exists for \/tmp",
                                        "command_list": [
                                            {
                                                "command": "mount[,][|]grep[,]\/tmp",
                                                "expectationPattern": "\\s*tmpfs on \/tmp type tmpfs\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.3",
                                        "description": "Ensure nodev option set on \/tmp partition",
                                        "command_list": [
                                            {
                                                "command": "mount[,][|]grep[,]\/tmp",
                                                "expectationPattern": "\\s*tmpfs on \/tmp type tmpfs \\(.*nodev.*\\)\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.4",
                                        "description": "Ensure nosuid option set on \/tmp partition",
                                        "command_list": [
                                            {
                                                "command": "mount[,][|]grep[,]\/tmp",
                                                "expectationPattern": "\\s*tmpfs on \/tmp type tmpfs \\(.*nosuid.*\\)\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.5",
                                        "description": "Ensure noexec option set on \/tmp partition",
                                        "command_list": [
                                            {
                                                "command": "mount[,][|]grep[,]\/tmp",
                                                "expectationPattern": "\\s*tmpfs on \/tmp type tmpfs \\(.*noexec.*\\)\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.6",
                                        "description": "Ensure separate partition exists for /var",
                                        "command_list": [
                                            {
                                                "command": "mount[|]grep[,]-E[,]\\s/var\\s",
                                                "expectationPattern": "^\\/dev\\/xvdg1 on \\/var type ext4 \\(rw,relatime,data=ordered\\)"
                                            }
                                        ],
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.7",
                                        "description": "Ensure separate partition exists for /var/tmp",
                                        "command_list": [
                                            {
                                                "command": "mount[|]grep[,]/var/tmp",
                                                "expectationPattern": ".+\\s+on \\/var\\/tmp type ext4 \\(rw,nosuid,nodev,noexec,relatime\\)"
                                            }
                                        ],
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.8",
                                        "description": "Ensure nodev option set on /var/tmp partition",
                                        "command_list": [
                                            {
                                                "command": "mount[,][|]grep[,]\/var\/tmp[,][|]grep[,]-v[,]nodev",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.9",
                                        "description": "Ensure nosuid option set on /var/tmp partition",
                                        "command_list": [
                                            {
                                                "command": "mount[,][|]grep[,]\/var\/tmp[,][|]grep[,]-v[,]nosuid",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.10",
                                        "description": "Ensure noexec option set on /var/tmp partition",
                                        "command_list": [
                                            {
                                                "command": "mount[,][|]grep[,]\/var\/tmp[,][|]grep[,]-v[,]noexec",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.11",
                                        "description": "Ensure separate partition exists for /var/log",
                                        "command_list": [
                                            {
                                                "command": "mount[|]grep[,]/var/log",
                                                "expectationPattern": "\\/dev\\/xvdh1 on \\/var\\/log type ext4 \\(rw,relatime,data=ordered\\)"
                                            }
                                        ],
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.12",
                                        "description": "Ensure separate partition exists for /var/log/audit",
                                        "command_list": [
                                            {
                                                "command": "mount[|]grep[,]/var/log/audit",
                                                "expectationPattern": "\\/dev\\/xvdh1 on \\/var\\/log\\/audit type ext4 \\(rw,relatime,data=ordered\\)"
                                            }
                                        ],
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.13",
                                        "description": " Ensure separate partition exists for /home",
                                        "command_list": [
                                            {
                                                "command": "mount[|]grep[,]/home",
                                                "expectationPattern": "\\/dev\\/xvdh1 on \\/home type ext4 \\(rw,nodev,relatime,data=ordered\\)"
                                            }
                                        ],
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.14",
                                        "description": "Ensure nodev option set on /home partition",
                                        "command_list": [
                                            {
                                                "command": "mount[,][|]grep[,]\/home[,][|]grep[,]-v[,]nodev",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.15",
                                        "description": "Ensure nodev option set on /dev/shm partition",
                                        "command_list": [
                                            {
                                                "command": "mount[,][|]grep[,]\/dev/shm[,][|]grep[,]-v[,]nodev",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.16",
                                        "description": "Ensure nosuid option set on /dev/shm partition",
                                        "command_list": [
                                            {
                                                "command": "mount[,][|]grep[,]\/dev/shm[,][|]grep[,]-v[,]nosuid",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.17",
                                        "description": "Ensure noexec option set on /dev/shm partition",
                                        "command_list": [
                                            {
                                                "command": "mount[,][|]grep[,]\/dev/shm[,][|]grep[,]-v[,]noexec",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.22",
                                        "description": "Disable Automounting",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "systemctl[,]is-enabled[,]autofs",
                                                "expectationPattern": "^disabled$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "dpkg[,]-s[,]autofs",
                                                "expectationPattern": "\\s*package 'autofs' is not installed\\s*"
                                            }
                                        ],
                                        "operator": "1||2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.1.22",
                                        "description": "Disable Automounting",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "1.1.23",
                                        "description": "Disable USB Storage",
                                        "pattern": "^\\s*install\\s+usb-storage\\s+\/bin\/true\\s*$",
                                        "path": "/etc/modprobe.d/usb_storage.conf",
                                        "level": "2WS,1SV",
                                        "type": "FILE_PATTERN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "1.2",
                        "name": "Configure Software Updates",
                        "groups": []
                    },
                    {
                        "id": "1.3",
                        "name": "Configure sudo",
                        "groups": [
                            {
                                "id": "1.3",
                                "report": [
                                    {
                                        "id": "1.3.1",
                                        "description": "Ensure sudo is installed",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "dpkg[,]-s[,]sudo",
                                                "expectationPattern": "\\s*Status: install ok installed\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "dpkg[,]-s[,]sudo-ldap",
                                                "expectationPattern": "\\s*Status: install ok installed\\s*"
                                            }
                                        ],
                                        "operator": "1||2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.3.2",
                                        "description": "Ensure sudo commands use pty",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "grep[,]-Ei[,]^\\s*Defaults use_pty\\s*$[,]/etc/sudoers",
                                                "expectationPattern": "\\s*Defaults use_pty\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]-Ei[,]^\\s*Defaults use_pty\\s*$[,]/etc/sudoers.d/README",
                                                "expectationPattern": "\\s*Defaults use_pty\\s*"
                                            }
                                        ],
                                        "operator": "1||2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.3.3",
                                        "description": "Ensure sudo log file exists",
                                        "command_list": [
                                            {
                                                "command": "grep[,]-Ei[,]^\\s*Defaults\\s+logfile=\\S+[,]/etc/sudoers[,]/etc/sudoers.d/README",
                                                "expectationPattern": "\\s*Defaults logfile=\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "1.4",
                        "name": "Configure sudo",
                        "groups": [
                            {
                                "id": "1.4",
                                "report": [
                                    {
                                        "id": "1.4.1",
                                        "description": "Ensure sudo is installed",
                                        "command_list": [
                                            {
                                                "command": "dpkg[,]-s[,]aide",
                                                "expectationPattern": "\\s*Status: install ok installed\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "1.5",
                        "name": "Secure Boot Settings",
                        "groups": [
                            {
                                "id": "1.5",
                                "report": [
                                    {
                                        "id": "1.5.1",
                                        "description": "Ensure permissions on bootloader config are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/boot/grub/grub.cfg",
                                                "expectationPattern": "\\s*Access:\\s+\\(0400\/-r--------\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.5.2",
                                        "description": "Ensure bootloader password is set",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "grep[,]^set superusers[,]/boot/grub/grub.cfg",
                                                "expectationPattern": "\\s*set\\s+superusers=\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]^password[,]/boot/grub/grub.cfg",
                                                "expectationPattern": "\\s*password_pbkdf2\\s*"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.5.3",
                                        "description": "Ensure authentication required for single user mode",
                                        "command_list": [
                                            {
                                                "command": "grep[,]^root:[*\\!]:[,]/etc/shadow",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "1.6",
                        "name": "Additional Process Hardening",
                        "groups": [
                            {
                                "id": "1.6",
                                "report": [
                                    {
                                        "id": "1.6.1",
                                        "description": "Ensure XD/NX support is enabled",
                                        "command_list": [
                                            {
                                                "command": "journalctl[|]grep[,]protection: active",
                                                "expectationPattern": "\\s*kernel:\\s+NX\\s+\\(Execute Disable\\)\\s+protection:\\s+active\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.6.2",
                                        "description": "Ensure address space layout randomization (ASLR) is enabled",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "sysctl[,]kernel.randomize_va_space",
                                                "expectationPattern": "\\s*kernel.randomize_va_space = 2\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]-iR[,]kernel\\.randomize_va_space[,]/etc/sysctl.conf[,]/etc/sysctl.d",
                                                "expectationPattern": "\\s*kernel.randomize_va_space = 2\\s*"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.6.3",
                                        "description": "Ensure prelink is disabled",
                                        "command_list": [
                                            {
                                                "command": "dpkg[,]-s[,]prelink",
                                                "expectationPattern": "\\s*package 'prelink' is not installed\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.6.4",
                                        "description": "Ensure core dumps are restricted",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "grep[,]-R[,]hard core[,]/etc/security/limits.conf[,]/etc/security/limits.d",
                                                "expectationPattern": "\\s*hard core 0\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "sysctl[,]fs.suid_dumpable",
                                                "expectationPattern": "\\s*fs.suid_dumpable\\*=\\s*0\\s*"
                                            },
                                            {
                                                "id": "3",
                                                "command": "grep[,]-R[,]fs\\.suid_dumpable[,]/etc/sysctl.conf[,]/etc/sysctl.d",
                                                "expectationPattern": "\\s*fs.suid_dumpable\\*=\\s*0\\s*"
                                            }
                                        ],
                                        "operator": "1&&2&&3",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "1.7",
                        "name": "Mandatory Access Control",
                        "groups": [
                            {
                                "id": "1.7.1",
                                "name": "Configure AppArmor",
                                "report": [
                                    {
                                        "id": "1.7.1.1",
                                        "description": "Ensure AppArmor is installed",
                                        "command_list": [
                                            {
                                                "command": "dpkg[,]-s[,]apparmor",
                                                "expectationPattern": "\\s*Status: install ok installed\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.7.1.2",
                                        "description": "Ensure address space layout randomization (ASLR) is enabled",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "grep[,]^\\s*linux[,]/boot/grub/grub.cfg[|]grep[,]-v[,]apparmor=1[|]grep[,]-v[,]/boot/memtest86+.bin",
                                                "expectationPattern": "^$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]^\\s*linux[,]/boot/grub/grub.cfg[|]grep[,]-v[,]security=apparmor[|]grep[,]-v[,]/boot/memtest86+.bin",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.7.1.3",
                                        "description": "Ensure all AppArmor Profiles are in enforce or complain mode",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "1.8",
                        "name": "Warning Banners",
                        "groups": [
                            {
                                "id": "1.8.1",
                                "name": "Command Line Warning Banners",
                                "report": [
                                    {
                                        "id": "1.8.1.1",
                                        "description": "Ensure message of the day is configured properly",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "1.8.1.2",
                                        "description": "Ensure local login warning banner is configured properly",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "1.8.1.3",
                                        "description": "Ensure remote login warning banner is configured properly",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "1.8.1.4",
                                        "description": "Ensure permissions on /etc/motd are configured",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "ls[,]/etc/motd",
                                                "expectationPattern": "\\s*No such file or directory\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "stat[,]/etc/motd",
                                                "expectationPattern": "\\s*Access:\\s+\\(0644\/-rw-r--r--\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "operator": "1||2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.8.1.5",
                                        "description": "Ensure permissions on /etc/issue are configured",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "ls[,]/etc/issue",
                                                "expectationPattern": "\\s*No such file or directory\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "stat[,]/etc/issue",
                                                "expectationPattern": "\\s*Access:\\s+\\(0644\/-rw-r--r--\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "operator": "1||2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.8.1.6",
                                        "description": "Ensure permissions on /etc/issue.net are configured",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "ls[,]/etc/issue.net",
                                                "expectationPattern": "\\s*No such file or directory\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "stat[,]/etc/issue.net",
                                                "expectationPattern": "\\s*Access:\\s+\\(0644\/-rw-r--r--\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "operator": "1||2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "1.8.2",
                                        "description": "Ensure GDM login banner is configured",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "ls[,]/etc/gdm3/greeter.dconf-defaults",
                                                "expectationPattern": "\\s*/etc/gdm3/greeter.dconf-defaults\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]^\\[org/gnome/login-screen\\][,]/etc/gdm3/greeter.dconf-defaults",
                                                "expectationPattern": "^\\s*\\[org\\/gnome\\/login-screen\\]\\s*(\\s+#.*)?$"
                                            },
                                            {
                                                "id": "3",
                                                "command": "grep[,]^banner\\-message\\-enable=true[,]/etc/gdm3/greeter.dconf-defaults",
                                                "expectationPattern": "^\\s*banner\\-message\\-enable\\s*=\\s*true\\s*(\\s+#.*)?$"
                                            },
                                            {
                                                "id": "4",
                                                "command": "grep[,]^banner\\-message\\-text=[,]/etc/gdm3/greeter.dconf-defaults",
                                                "expectationPattern": "^\\s*banner\\-message\\-text\\s*=\\s*'.+'\\s*(\\s+#.*)?$"
                                            }
                                        ],
                                        "operator": "1&&2&&3&&4",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "id": "2",
                "name": "Services",
                "categories": [
                    {
                        "id": "2.1",
                        "name": "inetd Services",
                        "groups": [
                            {
                                "id": "2.1",
                                "report": [
                                    {
                                        "id": "2.1.1",
                                        "description": "Ensure xinetd is not installed",
                                        "command_list": [
                                            {
                                                "command": "dpkg[,]-s[,]xinetd",
                                                "expectationPattern": "\\s*package 'xinetd' is not installed\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.1.2",
                                        "description": "Ensure openbsd-inetd is not installed",
                                        "command_list": [
                                            {
                                                "command": "dpkg[,]-s[,]openbsd-inetd",
                                                "expectationPattern": "\\s*package 'openbsd-inetd' is not installed\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "2.2",
                        "name": "Special Purpose Services",
                        "groups": [
                            {
                                "id": "2.2.1",
                                "name": " Time Synchronization",
                                "report": [
                                    {
                                        "id": "2.2.1.1",
                                        "description": "Ensure time synchronization is in use",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "systemctl[,]is-enabled[,]systemd-timesyncd",
                                                "expectationPattern": "enabled"
                                            },
                                            {
                                                "id": "2",
                                                "command": "dpkg[,]-s[,]chrony",
                                                "expectationPattern": "\\s*package 'chrony' is not installed\\s*"
                                            },
                                            {
                                                "id": "3",
                                                "command": "dpkg[,]-s[,]ntp",
                                                "expectationPattern": "\\s*package 'ntp' is not installed\\s*"
                                            }
                                        ],
                                        "operator": "1&&2&&3",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.1.3",
                                        "description": "Ensure chrony is configured",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "ls[,]/etc/chrony.conf",
                                                "expectationPattern": "/etc/chrony.conf"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]-E[,]^(server|pool)[,]/etc/chrony.conf",
                                                "expectationPattern": "^\\s*(server|pool)\\s+\\S+"
                                            },
                                            {
                                                "id": "3",
                                                "command": "ps[,]-ef[|]grep[,]chronyd",
                                                "expectationPattern": "^chrony\\s++"
                                            }
                                        ],
                                        "operator": "1||2&&3",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.1.4",
                                        "description": "Ensure ntp is configured",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "ls[,]/etc/ntp.conf",
                                                "expectationPattern": "/etc/ntp.conf"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]^restrict[,]/etc/ntp.conf",
                                                "expectationPattern": "^\\s*restrict\\s+-6\\s+default(\\s*\\bkod\\b\\s*|\\s*\\bnomodify\\b\\s*|\\s*\\bnotrap\\b\\s*|\\s*\\bnopeer\\b\\s*|\\s*\\bnoquery\\b\\s*)(\\s*\\bkod\\b\\s*|\\s*\\bnomodify\\b\\s*|\\s*\\bnotrap\\b\\s*|\\s*\\bnopeer\\b\\s*|\\s*\\bnoquery\\b\\s*)(\\s*\\bkod\\b\\s*|\\s*\\bnomodify\\b\\s*|\\s*\\bnotrap\\b\\s*|\\s*\\bnopeer\\b\\s*|\\s*\\bnoquery\\b\\s*)(\\s*\\bkod\\b\\s*|\\s*\\bnomodify\\b\\s*|\\s*\\bnotrap\\b\\s*|\\s*\\bnopeer\\b\\s*|\\s*\\bnoquery\\b\\s*)(\\s*\\bkod\\b\\s*|\\s*\\bnomodify\\b\\s*|\\s*\\bnotrap\\b\\s*|\\s*\\bnopeer\\b\\s*|\\s*\\bnoquery\\b\\s*)(?:#.*)?$"
                                            },
                                            {
                                                "id": "3",
                                                "command": "grep[,]^restrict[,]/etc/ntp.conf",
                                                "expectationPattern": "^\\s*restrict\\s+(-4\\s+)?default(\\s*\\bkod\\b\\s*|\\s*\\bnomodify\\b\\s*|\\s*\\bnotrap\\b\\s*|\\s*\\bnopeer\\b\\s*|\\s*\\bnoquery\\b\\s*)(\\s*\\bkod\\b\\s*|\\s*\\bnomodify\\b\\s*|\\s*\\bnotrap\\b\\s*|\\s*\\bnopeer\\b\\s*|\\s*\\bnoquery\\b\\s*)(\\s*\\bkod\\b\\s*|\\s*\\bnomodify\\b\\s*|\\s*\\bnotrap\\b\\s*|\\s*\\bnopeer\\b\\s*|\\s*\\bnoquery\\b\\s*)(\\s*\\bkod\\b\\s*|\\s*\\bnomodify\\b\\s*|\\s*\\bnotrap\\b\\s*|\\s*\\bnopeer\\b\\s*|\\s*\\bnoquery\\b\\s*)(\\s*\\bkod\\b\\s*|\\s*\\bnomodify\\b\\s*|\\s*\\bnotrap\\b\\s*|\\s*\\bnopeer\\b\\s*|\\s*\\bnoquery\\b\\s*)(?:#.*)?$"
                                            },
                                            {
                                                "id": "4",
                                                "command": "grep[,]^restrict[,]/etc/ntp.conf",
                                                "expectationPattern": "^\\s*(server|pool)\\s+\\S+"
                                            },
                                            {
                                                "id": "5",
                                                "command": "ls[,]/etc/sysconfig/ntp",
                                                "expectationPattern": "/etc/sysconfig/ntp"
                                            },
                                            {
                                                "id": "6",
                                                "command": "grep[,]^NTPD_OPTIONS[,]/etc/sysconfig/ntp",
                                                "expectationPattern": "^\\s*OPTIONS=\"[^\"]*-u ntp:ntp[^\"]*\"\\s*(?:#.*)?$"
                                            },
                                            {
                                                "id": "7",
                                                "command": "ls[,]/etc/sysconfig/ntpd",
                                                "expectationPattern": "/etc/sysconfig/ntpd"
                                            },
                                            {
                                                "id": "8",
                                                "command": "grep[,]^OPTIONS[,]/etc/sysconfig/ntpd",
                                                "expectationPattern": "^\\s*OPTIONS=\"[^\"]*-u ntp:ntp[^\"]*\"\\s*(?:#.*)?$"
                                            },
                                            {
                                                "id": "9",
                                                "command": "ls[,]/etc/init.d/ntp",
                                                "expectationPattern": "/etc/init.d/ntp"
                                            },
                                            {
                                                "id": "10",
                                                "command": "grep[,]RUNASUSER=ntp[,]/etc/init.d/ntp",
                                                "expectationPattern": "^\\s*RUNASUSER\\s*=\\s*ntp\\s*(?:#.*)?$"
                                            }
                                        ],
                                        "operator": "(1||2&&3&&4)&&(5||6)&&(7||8)&&(9||10)",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.2",
                                        "description": "Ensure X Window System is not installed",
                                        "command_list": [
                                            {
                                                "command": "dpkg[,]-l[,]xserver-xorg*[|]grep[,]xserver-xorg[|]grep[,]-v[,]<none>",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.3",
                                        "description": "Ensure Avahi Server is not enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]avahi-daemon",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.4",
                                        "description": "Ensure CUPS is not enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]cups",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "level": "2WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.5",
                                        "description": "Ensure DHCP Server is not enabled",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "systemctl[,]is-enabled[,]isc-dhcp-server",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "systemctl[,]is-enabled,isc-dhcp-server6",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.6",
                                        "description": "Ensure LDAP server is not enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled,slapd",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.7",
                                        "description": "Ensure NFS and RPC are not enabled",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "systemctl[,]is-enabled[,]nfs-server",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "systemctl[,]is-enabled[,]rpcbind",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.8",
                                        "description": "Ensure DNS Server is not enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]bind9",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.9",
                                        "description": "Ensure FTP Server is not enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]vsftpd",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.10",
                                        "description": "Ensure HTTP server is not enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]apache2",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.11",
                                        "description": "Ensure email services are not enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]dovecot",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.12",
                                        "description": "Ensure Samba is not enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]smbd",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.13",
                                        "description": "Ensure HTTP Proxy Server is not enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]squid",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.14",
                                        "description": "Ensure SNMP Server is not enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]snmpd",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.15",
                                        "description": "Ensure mail transfer agent is configured for local-only mode ",
                                        "command_list": [
                                            {
                                                "command": "ss[,]-lntu[|]grep[,]-E[,]:25\\s[|]grep[,]-E[,]-v[,]\\s\\(127\\.0\\.0\\.1|::1\\):25\\s",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.16",
                                        "description": "Ensure rsync service is not enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]rsync",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.2.17",
                                        "description": "Ensure NIS Server is not enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]nis",
                                                "expectationPattern": "^((?!enable)[\\s\\S])*$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "2.3",
                        "name": "Service Clients",
                        "groups": [
                            {
                                "id": "2.3",
                                "report": [
                                    {
                                        "id": "2.3.1",
                                        "description": "Ensure NIS Client is not installed",
                                        "command_list": [
                                            {
                                                "command": "dpkg[,]-s[,]nis",
                                                "expectationPattern": "\\s*package 'nis' is not installed\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.3.2",
                                        "description": "Ensure rsh client is not installed",
                                        "command_list": [
                                            {
                                                "command": "dpkg[,]-s[,]rsh-client",
                                                "expectationPattern": "\\s*package 'rsh-client' is not installed\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.3.3",
                                        "description": "Ensure talk client is not installed",
                                        "command_list": [
                                            {
                                                "command": "dpkg[,]-s[,]talk",
                                                "expectationPattern": "\\s*package 'talk' is not installed\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.3.4",
                                        "description": "Ensure telnet client is not installed",
                                        "command_list": [
                                            {
                                                "command": "dpkg[,]-s[,]telnet",
                                                "expectationPattern": "\\s*package 'telnet' is not installed\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "2.3.5",
                                        "description": "Ensure LDAP client is not installed",
                                        "command_list": [
                                            {
                                                "command": "dpkg[,]-s[,]ldap-utils",
                                                "expectationPattern": "\\s*package 'ldap-utils' is not installed\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "id": "3",
                "name": "Network Configuration",
                "categories": [
                    {
                        "id": "3.1",
                        "name": "Network Parameters(Host Only)",
                        "groups": [
                            {
                                "id": "3.1",
                                "report": [
                                    {
                                        "id": "3.1.1",
                                        "description": "Ensure packet redirect sending is disabled",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "sysctl[,]net.ipv4.conf.all.send_redirects",
                                                "expectationPattern": "\\s*net.ipv4.conf.all.send_redirects = 0\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "sysctl[,]net.ipv4.conf.default.send_redirects",
                                                "expectationPattern": "\\s*net.ipv4.conf.default.send_redirects = 0\\s*"
                                            },
                                            {
                                                "id": "3",
                                                "command": "grep[,]-R[,]net\\.ipv4\\.conf\\.all\\.send_redirects[,]/etc/sysctl.conf[,]/etc/sysctl.d",
                                                "expectationPattern": "\\s*net.ipv4.conf.all.send_redirects = 0\\s*"
                                            },
                                            {
                                                "id": "4",
                                                "command": "grep[,]-R[,]net\\.ipv4\\.conf\\.default\\.send_redirects[,]/etc/sysctl.conf[,]/etc/sysctl.d",
                                                "expectationPattern": "net.ipv4.conf.default.send_redirects = 0"
                                            }
                                        ],
                                        "operator": "1&&2&&3&&4",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "3.1.2",
                                        "description": "Ensure IP forwarding is disabled",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "sysctl[,]net.ipv4.ip_forward",
                                                "expectationPattern": "\\s*net.ipv4.ip_forward = 0\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]-E[,]-R[,]-s[,]^\\s*net\\.ipv4\\.ip_forward\\s*=\\s*1[,]/etc/sysctl.conf[,]/etc/sysctl.d[,]/usr/lib/sysctl.d[,]/run/sysctl.d",
                                                "expectationPattern": "^$"
                                            },
                                            {
                                                "id": "3",
                                                "command": "sysctl[,]net.ipv6.conf.all.forwarding",
                                                "expectationPattern": "^net.ipv6.conf.all.forwarding = 0\\s*$"
                                            },
                                            {
                                                "id": "4",
                                                "command": "grep[,]-E[,]-R[,]-s[,]^\\s*net\\.ipv6\\.conf\\.all\\.forwarding\\s*=\\s*1[,]/etc/sysctl.conf[,]/etc/sysctl.d[,]/usr/lib/sysctl.d[,]/run/sysctl.d",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "operator": "1&&2&&3&&4",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "3.2",
                        "name": "Network Parameters (Host and Router)",
                        "groups": [
                            {
                                "id": "3.2",
                                "report": [
                                    {
                                        "id": "3.2.1",
                                        "description": "Ensure source routed packets are not accepted",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "sysctl[,]net.ipv4.conf.all.accept_source_route",
                                                "expectationPattern": "\\s*net.ipv4.conf.all.accept_source_route = 0\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "sysctl[,]net.ipv4.conf.default.accept_source_route",
                                                "expectationPattern": "\\s*net.ipv4.conf.default.accept_source_route = 0\\s*"
                                            },
                                            {
                                                "id": "3",
                                                "command": "grep[,]-R[,]net\\.ipv4\\.conf\\.all\\.accept_source_route[,]/etc/sysctl.conf[,]/etc/sysctl.d",
                                                "expectationPattern": "^net.ipv4.conf.all.accept_source_route= 0\\s*$"
                                            },
                                            {
                                                "id": "4",
                                                "command": "grep[,]-R[,]net\\.ipv4\\.conf\\.default\\.accept_source_route[,]/etc/sysctl.conf[,]/etc/sysctl.d",
                                                "expectationPattern": "\\s*net.ipv4.conf.default.accept_source_route = 0\\s*"
                                            },
                                            {
                                                "id": "5",
                                                "command": "sysctl[,]net.ipv6.conf.all.accept_source_route",
                                                "expectationPattern": "\\s*net.ipv6.conf.all.accept_source_route = 0\\s*"
                                            },
                                            {
                                                "id": "6",
                                                "command": "sysctl[,]net.ipv6.conf.default.accept_source_route",
                                                "expectationPattern": "\\s*net.ipv6.conf.default.accept_source_route = 0\\s*"
                                            },
                                            {
                                                "id": "7",
                                                "command": "grep[,]-R[,]net\\.ipv6\\.conf\\.all\\.accept_source_route[,]/etc/sysctl.conf[,]/etc/sysctl.d",
                                                "expectationPattern": "^net.ipv4.conf.all.accept_source_route= 0\\s*$"
                                            },
                                            {
                                                "id": "8",
                                                "command": "grep[,]-R[,]net\\.ipv6\\.conf\\.default\\.accept_source_route[,]/etc/sysctl.conf[,]/etc/sysctl.d",
                                                "expectationPattern": "^net.ipv6.conf.default.accept_source_route= 0\\s*$"
                                            }
                                        ],
                                        "operator": "1&&2&&3&&4&&5&&6&&7&&8",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "3.3",
                        "name": "TCP Wrappers",
                        "groups": [
                            {
                                "id": "3.3",
                                "report": [
                                    {
                                        "id": "3.3.4",
                                        "description": "Ensure permissions on /etc/hosts.allow are configured",
                                        "command_list": [
                                            {
                                                "command": "statp[,]/etc/hosts.allow",
                                                "expectationPattern": "\\s*Access:\\s+\\(0644/-rw-r--r--\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "3.3.5",
                                        "description": "Ensure permissions on /etc/hosts.deny are configured",
                                        "command_list": [
                                            {
                                                "command": "statp[,]/etc/hosts.deny",
                                                "expectationPattern": "\\s*Access:\\s+\\(0644/-rw-r--r--\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "3.4",
                        "name": "Uncommon Network Protocols",
                        "groups": [
                            {
                                "id": "3.4",
                                "report": [
                                    {
                                        "id": "3.4.1",
                                        "description": "Ensure DCCP is disabled",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "modprobe[,]-n[,]-v[,]dccp",
                                                "expectationPattern": "\\s*install /bin/true\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "lsmod[,][|]grep[,]dccp",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "3.4.2",
                                        "description": "Ensure SCTP is disabled",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "modprobe[,]-n[,]-v[,]sctp",
                                                "expectationPattern": "\\s*install /bin/true\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "lsmod[,][|]grep[,]sctp",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "3.4.3",
                                        "description": "Ensure RDS is disabled",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "modprobe[,]-n[,]-v[,]rds",
                                                "expectationPattern": "\\s*install /bin/true\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "lsmod[,][|]grep[,]rds",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "3.4.4",
                                        "description": "Ensure TIPC is disabled",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "modprobe[,]-n[,]-v[,]tipc",
                                                "expectationPattern": "\\s*install /bin/true\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "lsmod[,][|]grep[,]tipc",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "3.5",
                        "name": "Firewall Configuration",
                        "groups": [
                            {
                                "id": "3.5.1",
                                "name": "Ensure Firewall software is installed",
                                "report": [
                                    {
                                        "id": "3.5.1.1",
                                        "description": "Ensure a Firewall package is installed",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "dpkg[,]-s[,]ufw[|]grep[,]-i[,]status",
                                                "expectationPattern": "\\s*Status: install ok installed\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "dpkg[,]-s[,]nftables[|]grep[,]-i[,]status",
                                                "expectationPattern": "\\s*Status: install ok installed\\s*"
                                            },
                                            {
                                                "id": "3",
                                                "command": "dpkg[,]-s[,]iptables[|]grep[,]-i[,]status",
                                                "expectationPattern": "\\s*Status: install ok installed\\s*"
                                            }
                                        ],
                                        "operator": "1&&2&&3",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            },
                            {
                                "id": "3.5.2",
                                "name": "Configure UncomplicatedFirewall",
                                "report": [
                                    {
                                        "id": "3.5.2.1",
                                        "description": "Ensure ufw service is enabled",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "systemctl[,]is-enabled[,]ufw",
                                                "expectationPattern": "enabled"
                                            },
                                            {
                                                "id": "2",
                                                "command": "ufw[,]status[|]grep[,]Status",
                                                "expectationPattern": "^Status: active$"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "3.5.2.2",
                                        "description": "Ensure default deny firewall policy",
                                        "command_list": [
                                            {
                                                "command": "ufw[,]status[,]verbose",
                                                "expectationPattern": "^\\s*Default:\\s++(deny|reject)\\s++\\(incoming\\),\\s++(deny|reject)\\s++\\(outgoing\\),\\s++(deny|reject)\\s++\\(routed\\)$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "3.5.2.3",
                                        "description": "Ensure loopback traffic is configured",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    }
                                ]
                            },
                            {
                                "id": "3.5.3",
                                "name": "Configure nftables",
                                "report": [
                                    {
                                        "id": "3.5.3.2",
                                        "description": "Ensure a table exists",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "nft[,]list[,]tables",
                                                "expectationPattern": "\\s*Command 'nft' not found\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "nft[,]list[,]tables",
                                                "expectationPattern": "\\s*table\\s*"
                                            }
                                        ],
                                        "operator": "1||2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "3.5.3.3",
                                        "description": "Ensure base chains exist",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "nft[,]list[,]ruleset[|]grep[,]hook input",
                                                "expectationPattern": "\\s*type filter hook input priority 0;\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "nft[,]list[,]ruleset[|]grep[,]hook forward",
                                                "expectationPattern": "\\s*type filter hook forward priority 0;\\s*"
                                            },
                                            {
                                                "id": "3",
                                                "command": "nft[,]list[,]ruleset[|]grep[,]hook output",
                                                "expectationPattern": "\\s*type filter hook output priority 0;\\s*"
                                            }
                                        ],
                                        "operator": "1&&2&&3",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "3.5.3.7",
                                        "description": "Ensure nftables service is enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]nftables",
                                                "expectationPattern": "\\s*enable\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            },
                            {
                                "id": "3.5.4",
                                "name": "Configure iptables",
                                "report": [
                                    {
                                        "id": "3.5.4.1.1",
                                        "description": "Ensure default deny firewall policy",
                                        "command_list": [
                                            {
                                                "command": "iptables[,]-L",
                                                "expectationPattern": ""
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "3.5.4.1.2",
                                        "description": "Ensure loopback traffic is configured",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "iptables[,]-L[,]INPUT[,]-v[,]-n",
                                                "expectationPattern": ""
                                            },
                                            {
                                                "id": "2",
                                                "command": "iptables[,]-L[,]OUTPUT[,]-v[,]-n",
                                                "expectationPattern": ""
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "3.5.4.1.4",
                                        "description": "Ensure firewall rules exist for all open ports",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "ss[,]-4tuln",
                                                "expectationPattern": ""
                                            },
                                            {
                                                "id": "2",
                                                "command": "iptables[,]-L[,]INPUT[,]-v[,]-n",
                                                "expectationPattern": ""
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "3.6",
                                        "description": "Ensure wireless interfaces are disabled",
                                        "command_list": [
                                            {
                                                "command": "nmcli[,]radio[,]all",
                                                "expectationPattern": ""
                                            }
                                        ],
                                        "level": "2WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "id": "4",
                "name": "Logging and Auditing",
                "categories": [
                    {
                        "id": "4.1",
                        "name": "Configure System Accounting (auditd)",
                        "groups": [
                            {
                                "id": "4.1.1",
                                "name": "Ensure auditing is enabled",
                                "report": [
                                    {
                                        "id": "4.1.1.1",
                                        "description": "Ensure auditd is installed",
                                        "command_list": [
                                            {
                                                "command": "dpkg[,]-s[,]auditd",
                                                "expectationPattern": "\\s*Status: install ok installed\\s*"
                                            }
                                        ],
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.1.1.2",
                                        "description": "Ensure auditd service is enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]auditd",
                                                "expectationPattern": "^enabled$"
                                            }
                                        ],
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.1.1.3",
                                        "description": "Ensure auditing for processes that start prior to auditd is enabled",
                                        "command_list": [
                                            {
                                                "command": "grep[,]-E[,]^\\s*linux[,]/boot/grub/grub.cfg[|]grep[,]-v[,]audit=1[|]grep[,]-v[,]/boot/memtest86+.bin",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.1.1.4",
                                        "description": "Ensure audit_backlog_limit is sufficient",
                                        "command_list": [
                                            {
                                                "command": "grep[,]-E[,]^\\s*linux[,]/boot/grub/grub.cfg[|]grep[,]-v[,]audit_backlog_limit=",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            },
                            {
                                "id": "4.1.2",
                                "name": "Configure Data Retention",
                                "report": [
                                    {
                                        "id": "4.1.2.1",
                                        "description": "Ensure audit log storage size is configured",
                                        "command_list": [
                                            {
                                                "command": "grep[,]max_log_file[,]/etc/audit/auditd.conf",
                                                "expectationPattern": "^\\s*max_log_file\\s*=\\s*\\S+\\s*(\\s+#.*)?$"
                                            }
                                        ],
                                        "level": "2WS,2SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "4.1.2.2",
                                        "description": "Ensure audit logs are not automatically deleted",
                                        "command_list": [
                                            {
                                                "command": "grep[,]max_log_file_action[,]/etc/audit/auditd.conf",
                                                "expectationPattern": "^\\s*max_log_file_action\\s*=\\s*keep_logs\\s*(\\s+#.*)?$"
                                            }
                                        ],
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.1.2.3",
                                        "description": "Ensure system is disabled when audit logs are full",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "grep[,]space_left_action[,]/etc/audit/auditd.conf",
                                                "expectationPattern": "^\\s*space_left_action\\s*=\\s*email\\s*(\\s+#.*)?$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]action_mail_acct[,]/etc/audit/auditd.conf",
                                                "expectationPattern": "^\\s*action_mail_acct\\s*=\\s*root\\s*(\\s+#.*)?$"
                                            },
                                            {
                                                "id": "3",
                                                "command": "grep[,]admin_space_left_action[,]/etc/audit/auditd.conf",
                                                "expectationPattern": "^\\s*admin_space_left_action\\s*=\\s*halt\\s*(\\s+#.*)?$"
                                            }
                                        ],
                                        "operator": "1&&2&&3",
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.1.3",
                                        "description": "Ensure system is disabled when audit logs are full",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^^-a\\s+always,exit\\s+-F\\s+arch=b32\\s+-S\\s+clock_settime\\s+-k\\s+time-change *$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^^-a\\s+always,exit\\s+-F\\s+arch=b32\\s+-S\\s+adjtimex\\s+-S\\s+settimeofday\\s+-S\\s+stime\\s+-k\\s+time-change *$"
                                            },
                                            {
                                                "id": "3",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^^-a\\s+always,exit\\s+-F\\s+arch=b64\\s+-S\\s+adjtimex\\s+-S\\s+settimeofday\\s+-k\\s+time-change *$"
                                            },
                                            {
                                                "id": "4",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^^-w\\s+/etc/localtime\\s+-p\\s+wa\\s+-k\\s+time-change *$"
                                            },
                                            {
                                                "id": "5",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^^-a\\s+always,exit\\s+-F\\s+arch=b64\\s+-S\\s+clock_settime\\s+-k\\s+time-change *$"
                                            }
                                        ],
                                        "operator": "1||2||3||4||5",
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.1.4",
                                        "description": "Ensure events that modify user/group information are collected",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/etc/security/opasswd\\s+-p\\s+wa\\s+-k\\s+identity *$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/etc/shadow\\s+-p\\s+wa\\s+-k\\s+identity *$"
                                            },
                                            {
                                                "id": "3",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/etc/gshadow\\s+-p\\s+wa\\s+-k\\s+identity *$"
                                            },
                                            {
                                                "id": "4",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/etc/passwd\\s+-p\\s+wa\\s+-k\\s+identity *$"
                                            },
                                            {
                                                "id": "5",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/etc/group\\s+-p\\s+wa\\s+-k\\s+identity *$"
                                            }
                                        ],
                                        "operator": "1||2||3||4||5",
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.1.5",
                                        "description": "Ensure events that modify the system's network environment are collected",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/etc/network\\s+-p\\s+wa\\s+-k\\s+system-locale *$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^^\\s*-w\\s+\\/etc\\/hosts\\s+-p\\s+wa\\s+-k\\s+system-locale\\s* *$"
                                            },
                                            {
                                                "id": "3",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/etc/issue.net\\s+-p\\s+wa\\s+-k\\s+system-locale *$"
                                            },
                                            {
                                                "id": "4",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/etc/issue\\s+-p\\s+wa\\s+-k\\s+system-locale *$"
                                            },
                                            {
                                                "id": "5",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-a\\s+always,exit\\s+-F\\s+arch=b32\\s+-S\\s+sethostname\\s+-S\\s+setdomainname\\s+-k\\s+system-locale *$"
                                            },
                                            {
                                                "id": "6",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-a\\s+always,exit\\s+-F\\s+arch=b64\\s+-S\\s+sethostname\\s+-S\\s+setdomainname\\s+-k\\s+system-locale *$"
                                            }
                                        ],
                                        "operator": "1||2||3||4||5||6",
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.1.6",
                                        "description": "Ensure events that modify the system's Mandatory Access Controls are collected",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/etc/apparmor(\\/)*\\s+-p\\s+wa\\s+-k\\s+MAC-policy *$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/etc/apparmor.d(\\/)*\\s+-p\\s+wa\\s+-k\\s+MAC-policy *$"
                                            }
                                        ],
                                        "operator": "1||2",
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.1.7",
                                        "description": "Ensure login and logout events are collected",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/var/log/tallylog\\s+-p\\s+wa\\s+-k\\s+logins *$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/var/log/faillog\\s+-p\\s+wa\\s+-k\\s+logins *$"
                                            },
                                            {
                                                "id": "3",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/var/log/lastlog\\s+-p\\s+wa\\s+-k\\s+logins *$"
                                            }
                                        ],
                                        "operator": "1||2||3",
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.1.8",
                                        "description": "Ensure session initiation information is collected",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/var/log/btmp\\s+-p\\s+wa\\s+-k\\s+logins *$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/var/log/wtmp\\s+-p\\s+wa\\s+-k\\s+logins *$"
                                            },
                                            {
                                                "id": "3",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/var/run/utmp\\s+-p\\s+wa\\s+-k\\s+session *$"
                                            }
                                        ],
                                        "operator": "1||2||3",
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.1.9",
                                        "description": "Ensure discretionary access control permission modification events are collected",
                                        "level": "2WS,2SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "4.1.10",
                                        "description": "Ensure unsuccessful unauthorized file access attempts are collected",
                                        "level": "2WS,2SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "4.1.11",
                                        "description": "Ensure use of privileged commands is collected",
                                        "level": "2WS,2SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "4.1.12",
                                        "description": "Ensure successful file system mounts are collected",
                                        "level": "2WS,2SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "4.1.13",
                                        "description": "Ensure file deletion events by users are collected",
                                        "level": "2WS,2SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "4.1.14",
                                        "description": "Ensure changes to system administration scope (sudoers) is collected",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/etc/sudoers\\s+-p\\s+wa\\s+-k\\s+scope *$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/etc/sudoers.d(/)*\\s+-p\\s+wa\\s+-k\\s+scope *$"
                                            }
                                        ],
                                        "operator": "1||2",
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.1.15",
                                        "description": "Ensure system administrator actions (sudolog) are collectedEnsure file deletion events by users are collected",
                                        "level": "2WS,2SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "4.1.16",
                                        "description": "Ensure kernel module loading and unloading is collected",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/sbin/modprobe\\s+-p\\s+x\\s+-k\\s+modules *$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/sbin/insmod\\s+-p\\s+x\\s+-k\\s+modules *$"
                                            },
                                            {
                                                "id": "3",
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-w\\s+/sbin/rmmod\\s+-p\\s+x\\s+-k\\s+modules *$"
                                            }
                                        ],
                                        "operator": "1||2||3",
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.1.17",
                                        "description": "Ensure the audit configuration is immutable",
                                        "command_list": [
                                            {
                                                "command": "cat[,]/etc/audit/audit.rules",
                                                "expectationPattern": "^-e\\s+2 *$"
                                            }
                                        ],
                                        "level": "2WS,2SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "4.2",
                        "name": "Configure Logging",
                        "groups": [
                            {
                                "id": "4.2.1",
                                "name": "Configure rsyslog",
                                "report": [
                                    {
                                        "id": "4.2.1.1",
                                        "description": "Ensure rsyslog is installed",
                                        "command_list": [
                                            {
                                                "command": "dpkg[,]-s[,]rsyslog",
                                                "expectationPattern": "\\s*Status: install ok installed\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.2.1.2",
                                        "description": "Ensure rsyslog Service is enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]rsyslog",
                                                "expectationPattern": "\\s*enabled\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.2.1.4",
                                        "description": "Ensure rsyslog default file permissions configured",
                                        "command_list": [
                                            {
                                                "command": "grep[,]-E[,]-R[,]^\\$FileCreateMode[,]/etc/rsyslog.conf[,]/etc/rsyslog.d",
                                                "expectationPattern": "^\\s*\\$FileCreateMode\\s+0[6420][40]0\\s*(\\s+#.*)?$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.2.1.5",
                                        "description": "Ensure rsyslog is configured to send logs to a remote log host",
                                        "command_list": [
                                            {
                                                "command": "grep[,]-E][,]-R[,]^[^#](\\s*\\S++\\s*)\\s*action\\([,]/etc/rsyslog.conf[,]/etc/rsyslog.d[|]grep[.]target=[.]",
                                                "expectationPattern": "^\\s*target=\\s*.+(\\s+#.*)?$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            },
                            {
                                "id": "4.2.2",
                                "name": "Configure journald",
                                "report": [
                                    {
                                        "id": "4.2.2.1",
                                        "description": "Ensure journald is configured to send logs to rsyslog",
                                        "command_list": [
                                            {
                                                "command": "grep[,]-E[,]-i[,]^\\s*ForwardToSyslog[,]/etc/systemd/journald.conf",
                                                "expectationPattern": "\\s*ForwardToSyslog=yes\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.2.2.2",
                                        "description": "Ensure journald is configured to compress large log files",
                                        "command_list": [
                                            {
                                                "command": "grep[,]-E[,]-i[,]^\\s*Compress[,]/etc/systemd/journald.conf",
                                                "expectationPattern": "\\s*Compress=yes\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.2.2.3",
                                        "description": "Ensure journald is configured to write logfiles to persistent disk",
                                        "command_list": [
                                            {
                                                "command": "grep[,]-E[,]-i[,]^\\s*Storage[,]/etc/systemd/journald.conf",
                                                "expectationPattern": "\\s*Storage=persistent\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "4.2.3",
                                        "description": "Ensure permissions on all logfiles are configured",
                                        "command_list": [
                                            {
                                                "command": "find[,]/var/log[,]-type[,]f[,]-ls[|]grep[,]-Ev[,]\\-\\-\\-\\-\\-\\s++",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "id": "5",
                "name": "Access, Authentication and Authorization",
                "categories": [
                    {
                        "id": "5.1",
                        "name": "Configure cron",
                        "groups": [
                            {
                                "id": "5.1",
                                "report": [
                                    {
                                        "id": "5.1.1",
                                        "description": "Ensure cron daemon is enabled",
                                        "command_list": [
                                            {
                                                "command": "systemctl[,]is-enabled[,]cron",
                                                "expectationPattern": "^enabled$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.1.2",
                                        "description": "Ensure permissions on /etc/crontab are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/crontab",
                                                "expectationPattern": "\\s*Access:\\s+\\(0600\/-rw-------\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.1.3",
                                        "description": "Ensure permissions on /etc/cron.hourly are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/cron.hourly",
                                                "expectationPattern": "\\s*Access:\\s+\\(0700\/drwx------\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.1.4",
                                        "description": "Ensure permissions on /etc/cron.daily are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/cron.daily",
                                                "expectationPattern": "\\s*Access:\\s+\\(0700\/drwx------\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.1.5",
                                        "description": "Ensure permissions on /etc/cron.weekly are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/cron.weekly",
                                                "expectationPattern": "\\s*Access:\\s+\\(0700\/drwx------\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.1.6",
                                        "description": "Ensure permissions on /etc/cron.monthly are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/cron.monthly",
                                                "expectationPattern": "\\s*Access:\\s+\\(0700\/drwx------\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.1.7",
                                        "description": "Ensure permissions on /etc/cron.d are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/cron.d",
                                                "expectationPattern": "\\s*Access:\\s+\\(0700\/drwx------\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.1.8",
                                        "description": "Ensure at/cron is restricted to authorized users",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "stat[,]/etc/cron.deny",
                                                "expectationPattern": "\\s*cannot stat '/etc/cron.deny': No such file or directory\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "stat[,]/etc/at.deny",
                                                "expectationPattern": "\\s*cannot stat '/etc/at.deny': No such file or directory\\s*"
                                            },
                                            {
                                                "id": "3",
                                                "command": "stat[,]/etc/at.deny",
                                                "expectationPattern": "\\s*Access:\\s+\\(0640\/-rw-r-----\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            },
                                            {
                                                "id": "4",
                                                "command": "stat[,]/etc/at.deny",
                                                "expectationPattern": "\\s*Access:\\s+\\(0640\/-rw-r-----\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "operator": "1&&2&&3&&4",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "5.2",
                        "name": "SSH Server Configuration",
                        "groups": [
                            {
                                "id": "5.2",
                                "report": [
                                    {
                                        "id": "5.2.1",
                                        "description": "Ensure permissions on /etc/ssh/sshd_config are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/ssh/sshd_config",
                                                "expectationPattern": "\\s*Access:\\s+\\(0600\/-rw-------\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.2",
                                        "description": "Ensure permissions on SSH private host key files are configured",
                                        "command_list": [
                                            {
                                                "command": "find[,]/etc/ssh[,]-xdev[,]-type[,]f[,]-name[,]ssh_host_*_key[,]-exec[,]stat[,]{},;[|]grep[,]'Access:.*Uid'[|]grep[,]0600.*0/\\s*root.*0/\\s*root[,]-v",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.3",
                                        "description": "Ensure permissions on SSH public host key files are configured",
                                        "command_list": [
                                            {
                                                "command": "find[,]/etc/ssh[,]-xdev[,]-type[,]f[,]-name[,]ssh_host_*_key.pub[,]-exec[,]stat[,]{},;[|]grep[,]'Access:.*Uid'[|]grep[,]0644.*0/\\s*root.*0/\\s*root[,]-v",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.4",
                                        "description": "Ensure SSH Protocol is not set to 1",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]-Ei[,]'^\\s*protocol\\s+\\(1|1\\s*,\\s*2|2\\s*,\\s*1\\)\\s*'",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.5",
                                        "description": "Ensure SSH LogLevel is appropriate",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]loglevel",
                                                "expectationPattern": "\\s*(LogLevel VERBOSE)|(loglevel INFO)\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.6",
                                        "description": "Ensure SSH X11 forwarding is disabled",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]x11forwarding",
                                                "expectationPattern": "\\s*X11Forwarding no\\s*"
                                            }
                                        ],
                                        "level": "1WS,2SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.7",
                                        "description": "Ensure SSH MaxAuthTries is set to 4 or less",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]maxauthtries",
                                                "expectationPattern": "\\s*MaxAuthTries [1-4]\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.8",
                                        "description": "Ensure SSH IgnoreRhosts is enabled",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]ignorerhosts",
                                                "expectationPattern": "\\s*IgnoreRhosts yes\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.9",
                                        "description": "Ensure SSH HostbasedAuthentication is disabled",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]hostbasedauthentication",
                                                "expectationPattern": "\\s*HostbasedAuthentication no\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.10",
                                        "description": "Ensure SSH root login is disabled",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]permitrootlogin",
                                                "expectationPattern": "\\s*PermitRootLogin no\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.11",
                                        "description": "Ensure SSH PermitEmptyPasswords is disabled",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]permitemptypasswords",
                                                "expectationPattern": "\\s*PermitEmptyPasswords no\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.12",
                                        "description": "Ensure SSH PermitUserEnvironment is disabled",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]permituserenvironment",
                                                "expectationPattern": "\\s*PermitUserEnvironment no\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.13",
                                        "description": "Ensure only strong Ciphers are used",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]cipher[|]grep[,]3des-cbc\\|aes128-cbc\\|aes192-cbc\\|aes256-cbc\\|arcfour\\|arcfour128\\|arcfour256\\|blowfish-cbc\\|cast128-cbc\\|rijndael-cbc@lysator.liu.se",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.14",
                                        "description": "Ensure only strong MAC algorithms are used",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]-i[,]MACs[|]grep[,]hmac-md5\\|hmac-md5-96\\|hmac-ripemd160\\|hmac-sha1\\|hmac-sha1-96\\|umac-64@openssh.com\\|umac-128@openssh.com\\|hmac-md5-etm@openssh.com\\|hmac-md5-96-etm@openssh.com\\|hmac-ripemd160-etm@openssh.com\\|hmac-sha1-etm@openssh.com\\|hmac-sha1-96-etm@openssh.com\\|umac-64-etm@openssh.com\\|umac-128-etm@openssh.com",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.15",
                                        "description": "Ensure only strong Key Exchange algorithms are used",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]kexalgorithms[|]grep[,]diffie-hellman-group1-sha1\\|diffie-hellman-group14-sha1\\|diffie-hellman-group-exchange-sha1",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.16",
                                        "description": "Ensure only strong Key Exchange algorithms are used",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "sshd[,]-T[|]grep[,]clientaliveinterval",
                                                "expectationPattern": "^ClientAliveInterval (0*([0-9]|[1-8][0-9]|9[0-9]|300))$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "sshd[,]-T[|]grep[,]clientalivecountmax",
                                                "expectationPattern": "\\s*ClientAliveCountMax [0-3]\\s*"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.17",
                                        "description": "Ensure SSH LoginGraceTime is set to one minute or less",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]logingracetime",
                                                "expectationPattern": "^LoginGraceTime (0*([1-9]|[1-5]|60))$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.18",
                                        "description": "Ensure SSH access is limited",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]logingracetime",
                                                "expectationPattern": "^LoginGraceTime (0*([1-9]|[1-5]|60))$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.18",
                                        "description": "Ensure SSH access is limited",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "sshd[,]-T[|]grep[,]allowusers",
                                                "expectationPattern": "\\s*AllowUsers\\s*"
                                            },
                                            {
                                                "id": "2",
                                                "command": "sshd[,]-T[|]grep[,]allowgroups",
                                                "expectationPattern": "\\s*AllowGroups\\s*"
                                            },
                                            {
                                                "id": "3",
                                                "command": "sshd[,]-T[|]grep[,]denyusers",
                                                "expectationPattern": "\\s*DenyUsers\\s*"
                                            },
                                            {
                                                "id": "4",
                                                "command": "sshd[,]-T[|]grep[,]denygroups",
                                                "expectationPattern": "\\s*DenyGroups\\s*"
                                            }
                                        ],
                                        "operator": "1||2||3||4",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.19",
                                        "description": "Ensure SSH warning banner is configured",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]banner",
                                                "expectationPattern": "\\s*Banner /etc/issue.net\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.20",
                                        "description": "Ensure SSH PAM is enabled",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]-i[,]usepam",
                                                "expectationPattern": "\\s*usepam yes\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.21",
                                        "description": "Ensure SSH PAM is enabled",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]-i[,]allowtcpforwarding",
                                                "expectationPattern": "\\s*AllowTcpForwarding no\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.22",
                                        "description": "Ensure SSH PAM is enabled",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]-i[,]maxstartups",
                                                "expectationPattern": "\\s*MaxStartups 10:30:60\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.2.23",
                                        "description": "Ensure SSH MaxSessions is set to 4 or less",
                                        "command_list": [
                                            {
                                                "command": "sshd[,]-T[|]grep[,]-i[,]maxsessions",
                                                "expectationPattern": "\\s*maxsessions 4\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "5.3",
                        "name": "Configure PAM",
                        "groups": [
                            {
                                "id": "5.3",
                                "report": [
                                    {
                                        "id": "5.3.1",
                                        "description": "Ensure permissions on /etc/cron.d are configured",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "grep[,]^\\s*minlen\\s*[,]/etc/security/pwquality.conf",
                                                "expectationPattern": "^\\s*minlen\\s*=\\s*(1[4-9]|[2-9][0-9]|[1-9][0-9][0-9])(\\s+#.*)*$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]^\\s*minclass\\s*[,]/etc/security/pwquality.conf",
                                                "expectationPattern": "^minclass\\s*=\\s*0*([4-9]|[1-9]\\d{2,})$*"
                                            },
                                            {
                                                "id": "3",
                                                "command": "grep[,]-E[,]^\\s*\\[duol\\]credit\\s*[,]/etc/security/pwquality.conf",
                                                "expectationPattern": "^\\s*dcredit = -1\\s*(\\s+#.*)*\\s*ucredit = -1\\s*(\\s+#.*)*\\s*lcredit = -1\\s*(\\s+#.*)*\\s*ocredit = -1\\s*(\\s+#.*)*\\s*$"
                                            },
                                            {
                                                "id": "4",
                                                "command": "grep[,]^\\s*password\\s\\+\\(requisite\\|required\\)\\s\\+pam_pwquality\\.so\\s\\+\\(\\S\\+\\s\\+\\)*retry=[1-3]\\s*\\(\\s\\+\\S\\+\\s*\\)*\\(\\s\\+#.*\\)\\?$[,]/etc/pam.d/common-password",
                                                "expectationPattern": "^password\\s*requisite\\s*pam_pwquality.so\\s*retry=3\\s*(\\s+#.*)*$"
                                            }
                                        ],
                                        "operator": "(1&&2)||(3&&4)",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.3.2",
                                        "description": "Ensure lockout for failed password attempts is configured",
                                        "command_list": [
                                            {
                                                "command": "grep[,]pam_tally2[,]/etc/pam.d/common-auth",
                                                "expectationPattern": "^\\s*auth required pam_tally2.so onerr=fail audit silent deny=5 unlock_time=900\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.3.3",
                                        "description": "Ensure lockout for failed password attempts is configured",
                                        "command_list": [
                                            {
                                                "command": "grep[,]^password\\s\\+required\\s\\+pam_pwhistory\\.so[,]/etc/pam.d/common-password",
                                                "expectationPattern": "^\\s*password\\s\\+required\\s\\+pam_pwhistory.so\\s\\+remember=5\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.3.4",
                                        "description": "Ensure password hashing algorithm is SHA-512",
                                        "command_list": [
                                            {
                                                "command": "grep[,]^\\s*password\\s\\+\\(\\S\\+\\s\\+\\)\\+pam_unix\\.so\\s\\+\\(\\S\\+\\s\\+\\)*sha512\\s*\\(\\S\\+\\s*\\)*\\(\\s\\+#.*\\)\\?$[,]/etc/pam.d/common-password",
                                                "expectationPattern": "^\\s*password\\s\\+\\[success=1\\s\\+default=ignore\\]\\s\\+pam_unix.so\\s\\+obscure\\s\\+sha512\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "5.4",
                        "name": "User Accounts and Environment",
                        "groups": [
                            {
                                "id": "5.4.1",
                                "name": "Set Shadow Password Suite Parameters",
                                "report": [
                                    {
                                        "id": "5.4.1.1",
                                        "description": "Ensure password expiration is 365 days or less",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "grep[,]^PASS_MAX_DAYS[,]/etc/login.defs",
                                                "expectationPattern": "^PASS_MAX_DAYS\\s+0*(?:36[0-5]|3[0-5]\\d|[12]\\d{2}|[1-9]\\d?)\\s*(\\s+#.*)*$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]-E[,]^[^:]++:[^!*][,]/etc/shadow[|]cut[,]-d:[,]-f1,5",
                                                "expectationPattern": "^.*:0*(?:36[0-5]|3[0-5]\\d|[12]\\d{2}|[1-9]\\d?)\\s*(\\s+#.*)*$"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.4.1.2",
                                        "description": "Ensure minimum days between password changes is configured",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "grep[,]^PASS_MIN_DAYS[,]/etc/login.defs",
                                                "expectationPattern": "^PASS_MIN_DAYS\\s+0*[1-9][0-9]*\\s*(\\s+#.*)*$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]-E[,]^[^:]++:[^!*][,]/etc/shadow[|]cut[,]-d:[,]-f1,4",
                                                "expectationPattern": "^.*:0*[1-9][0-9]*\\s*(\\s+#.*)*$"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.4.1.3",
                                        "description": "Ensure password expiration warning days is 7 or more",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "grep[,]^PASS_WARN_AGE[,]/etc/login.defs",
                                                "expectationPattern": "^PASS_WARN_AGE\\s+0*([7-9]|[1-9]{2,})\\s*(\\s+#.*)*$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]-E[,]^[^:]++:[^!*][,]/etc/shadow[|]cut[,]-d:[,]-f1,6",
                                                "expectationPattern": "^.*:0*([7-9]|[1-9]{2,})\\s*(\\s+#.*)*$"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.4.1.4",
                                        "description": "Ensure inactive password lock is 30 days or less",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "useradd[,]-D[|]grep[,]INACTIVE",
                                                "expectationPattern": "^INACTIVE\\s+=\\s+0*([0-9]|[1-2][0-9]|30)\\s*(\\s+#.*)*$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]-E[,]^[^:]++:[^!*][,]/etc/shadow[|]cut[,]-d:[,]-f1,7",
                                                "expectationPattern": "^.*:0*([0-9]|[1-2][0-9]|30)\\s*(\\s+#.*)*$"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.4.1.5",
                                        "description": "Ensure inactive password lock is 30 days or less",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "5.4.2",
                                        "description": "Ensure system accounts are secured",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "5.4.3",
                                        "description": "Ensure default group for the root account is GID 0",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "grep[,]-E[,]^root:[,]/etc/passwd[|]cut[,]-f4[,]-d:",
                                                "expectationPattern": "^\\s*0\\s*(\\s+#.*)*$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.4.4",
                                        "description": "Ensure default user umask is 027 or more restrictive",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "grep[,]umask[,]/etc/bash.bashrc",
                                                "expectationPattern": "^\\s*umask\\s+[01234567][2367]7\\s*(\\s+#.*)?$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]-R[,]umask[,]/etc/profile[,]/etc/profile.d",
                                                "expectationPattern": "^\\s*umask\\s+[01234567][2367]7\\s*(\\s+#.*)?$"
                                            }
                                        ],
                                        "operator": "1&&2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.4.5",
                                        "description": "Ensure default user shell timeout is 900 seconds or less",
                                        "command_list": [
                                            {
                                                "id": "1",
                                                "command": "grep[,]-E[,]-i[,]^\\s*\\(\\S++\\s++\\)*TMOUT=\\(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9]\\)\\s*\\(\\S++\\s*\\)*\\(\\s++#.*\\)?$[,]/etc/bash.bashrc",
                                                "expectationPattern": "^\\s*(\\S+\\s+)*TMOUT=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9])\\b\\s*(\\S+\\s*)*(\\s+#.*)?$"
                                            },
                                            {
                                                "id": "2",
                                                "command": "grep[,]-E[,]-i[,]^\\s*\\(\\S++\\s++\\)*TMOUT=\\(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9]\\)\\s*\\(\\S++\\s*\\)*\\(\\s++#.*\\)?$[,]/etc/profile[,]/etc/profile.d",
                                                "expectationPattern": "^\\s*umask\\s+[01234567][2367]7\\s*(\\s+#.*)?$"
                                            }
                                        ],
                                        "operator": "1||2",
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "5.6",
                                        "description": "Ensure access to the su command is restricted",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "id": "6",
                "name": "System Maintenance",
                "categories": [
                    {
                        "id": "6.1",
                        "name": "System File Permissions",
                        "groups": [
                            {
                                "id": "6.1",
                                "report": [
                                    {
                                        "id": "6.1.2",
                                        "description": "Ensure permissions on /etc/passwd are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/passwd",
                                                "expectationPattern": "\\s*Access:\\s+\\(0644\/-rw-r--r--\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.1.3",
                                        "description": "Ensure permissions on /etc/gshadow- are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/gshadow-",
                                                "expectationPattern": "\\s*Access:\\s+\\(0640\/-rw-r-----\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.1.4",
                                        "description": "Ensure permissions on /etc/shadow are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/shadow",
                                                "expectationPattern": "\\s*Access:\\s+\\(0640\/-rw-r-----\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.1.5",
                                        "description": "Ensure permissions on /etc/group are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/shadow",
                                                "expectationPattern": "\\s*Access:\\s+\\(0644\/-rw-r--r--\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.1.6",
                                        "description": "Ensure permissions on /etc/passwd- are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/passwd-",
                                                "expectationPattern": "\\s*Access:\\s+\\(0600\/-rw-------\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.1.7",
                                        "description": "Ensure permissions on /etc/shadow- are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/shadow-",
                                                "expectationPattern": "\\s*Access:\\s+\\(0600\/-rw-------\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.1.8",
                                        "description": "Ensure permissions on /etc/group- are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/group-",
                                                "expectationPattern": "\\s*Access:\\s+\\(0644\/-rw-r--r--\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.1.9",
                                        "description": "Ensure permissions on /etc/gshadow are configured",
                                        "command_list": [
                                            {
                                                "command": "stat[,]/etc/gshadow",
                                                "expectationPattern": "\\s*Access:\\s+\\(0640\/-rw-r-----\\)\\s+Uid:\\s+\\(\\s+0\\/\\s+root\\)\\s+Gid:\\s+\\(\\s+0\\/\\s+root\\s*"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.1.10",
                                        "description": "Ensure no world writable files exist",
                                        "command_list": [
                                            {
                                                "command": "find[,]/[,]-path[,]/proc[,]-prune[,]-o[,]-path[,]/sys[,]-prune[,]-o[,]-type[,]f[,]-perm[,]-0002",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.1.11",
                                        "description": "Ensure no unowned files or directories exist",
                                        "command_list": [
                                            {
                                                "command": "df[,]--local[,]-P[|]awk[,]{if(NR!=1)print$6}[|]xargs[,]-I[,]'{}'[,]find[,]'{}'[,]-xdev[,]-nouser",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.1.12",
                                        "description": "Ensure no ungrouped files or directories exist",
                                        "command_list": [
                                            {
                                                "command": "df[,]--local[,]-P[|]awk[,]{if(NR!=1)print$6}[|]xargs[,]-I[,]'{}'[,]find[,]'{}'[,]-xdev[,]-nogroup",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "6.2",
                        "name": "User and Group Settings",
                        "groups": [
                            {
                                "id": "6.2",
                                "report": [
                                    {
                                        "id": "6.2.1",
                                        "description": "Ensure password fields are not empty",
                                        "command_list": [
                                            {
                                                "command": "awk[,]-F:[,]($2==''){print$1}[,]/etc/shadow",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.2.2",
                                        "description": "Ensure no legacy \"+\" entries exist in /etc/passwd",
                                        "command_list": [
                                            {
                                                "command": "grep[,]-E[,]^\\++:[,]/etc/passwd",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.2.3",
                                        "description": "Ensure all users' home directories exist ",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.4",
                                        "description": "Ensure no legacy \"+\" entries exist in /etc/shadow",
                                        "command_list": [
                                            {
                                                "command": "grep[,]-E[,]^\\++:[,]/etc/shadow",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.2.5",
                                        "description": "Ensure no legacy \"+\" entries exist in /etc/group",
                                        "command_list": [
                                            {
                                                "command": "grep[,]-E[,]^\\++:[,]/etc/group",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.2.6",
                                        "description": "Ensure root is the only UID 0 account",
                                        "command_list": [
                                            {
                                                "command": "awk[,]-F:[,]($3==0){print$1}[,]/etc/passwd",
                                                "expectationPattern": "^root$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "SHELL_RUN"
                                    },
                                    {
                                        "id": "6.2.7",
                                        "description": "Ensure root PATH Integrity",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.8",
                                        "description": "Ensure users' home directories permissions are 750 or more restrictive",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.9",
                                        "description": "Ensure users own their home directories",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.10",
                                        "description": "Ensure users' dot files are not group or world writable",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.11",
                                        "description": "Ensure no users have .forward files",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.12",
                                        "description": "Ensure no users have .netrc files",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.13",
                                        "description": "Ensure users' .netrc Files are not group or world accessible",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.14",
                                        "description": "Ensure no users have .rhosts files",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.15",
                                        "description": "Ensure all groups in /etc/passwd exist in /etc/group",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.16",
                                        "description": "Ensure no duplicate UIDs exist",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.17",
                                        "description": "Ensure no duplicate GIDs exist",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.18",
                                        "description": "Ensure no duplicate user names exist",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.19",
                                        "description": "Ensure no duplicate group names exist",
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    },
                                    {
                                        "id": "6.2.20",
                                        "description": "Ensure shadow group is empty",
                                        "command_list": [
                                            {
                                                "command": "grep[,]-E[,]^shadow:[^:]*:[^:]*:[^:]++[,]/etc/group",
                                                "expectationPattern": "^$"
                                            }
                                        ],
                                        "level": "1WS,1SV",
                                        "type": "UNKNOWN"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        ]
    }
}